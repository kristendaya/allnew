<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>NETFLIX & TRIP</title>
    <link rel="stylesheet" href="css.css" />
    <script>
        function getHello() {
            const xhr = new XMLHttpRequest();
            const method = "GET";
            const url = "/hello";
            xhr.open(method, url);
            xhr.send();

            xhr.onreadystatechange = function () {
                if (xhr.readyState !== 4) return;

                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    const element = document.getElementById("ss1");
                    element.innerHTML = xhr.responseText;
                } else {
                    console.log("HTTP error", xhr.status, xhr.statusText);
                }
            };
        }

        function dropMongo() {
            const xhr = new XMLHttpRequest();
            const method = "GET";
            const url = "/dropmongo";
            xhr.open(method, url);
            xhr.send();

            xhr.onreadystatechange = function () {
                if (xhr.readyState !== 4) return;

                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    const element = document.getElementById("ss2");
                    element.innerHTML = xhr.responseText;
                } else {
                    console.log("HTTP error", xhr.status, xhr.statusText);
                }
            };
        }

        function insertMongo() {
            const xhr = new XMLHttpRequest();
            const method = "GET";
            const url = "/insertmongo";
            xhr.open(method, url);
            xhr.send();

            xhr.onreadystatechange = function () {
                if (xhr.readyState !== 4) return;

                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    const element = document.getElementById("ss3");
                    element.innerHTML = xhr.responseText;
                } else {
                    console.log("HTTP error", xhr.status, xhr.statusText);
                }
            };
        }

        function getData() {
            const start = document.getElementById("start").value;
            const end = document.getElementById("end").value;

            const xhr = new XMLHttpRequest();
            const method = "GET";
            const url = `/getdata?start=${start}&end=${end}`;
            xhr.open(method, url);
            xhr.send();

            xhr.onreadystatechange = function () {
                if (xhr.readyState !== 4) return;

                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    const element = document.getElementById("ss4");
                    element.innerHTML = xhr.responseText;
                } else {
                    console.log("HTTP error", xhr.status, xhr.statusText);
                }
            };
        }

        function getGraphByDate() {
            const start = document.getElementById("start").value;
            const end = document.getElementById("end").value;

            const xhr = new XMLHttpRequest();
            const method = "GET";
            const url = `/graph_by_date?start=${start}&end=${end}`;
            xhr.open(method, url);
            xhr.send();

            xhr.onreadystatechange = function () {
                if (xhr.readyState !== 4) return;

                if (xhr.status === 200) {
                    console.log(xhr.response);
                    const element = document.getElementById("ss5");
                    element.innerHTML = `<img src="graph1_data_by_date.png" alt="Graph by Date">`;
                } else {
                    console.log("HTTP error", xhr.status, xhr.statusText);
                }
            };
        }


        function getGraphByNationality() {
            const nationality = document.getElementById("nationality").value;

            const xhr = new XMLHttpRequest();
            const method = "GET";
            const url = `/get_gra_by_nationality?nationality=${nationality}`;
            xhr.open(method, url);
            xhr.send();

            xhr.onreadystatechange = function () {
                if (xhr.readyState !== 4) return;

                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    const element = document.getElementById("ss6");
                    element.innerHTML = xhr.responseText;
                } else {
                    console.log("HTTP error", xhr.status, xhr.statusText);
                }
            };
        }

        function getTop() {
            const start = document.getElementById("start").value;
            const end = document.getElementById("end").value;

            const xhr = new XMLHttpRequest();
            const method = "GET";
            const url = `/get_top?start=${start}&end=${end}`;
            xhr.open(method, url);
            xhr.send();

            xhr.onreadystatechange = function () {
                if (xhr.readyState !== 4) return;

                if (xhr.status === 200) {
                    console.log(xhr.responseText);
                    const element = document.getElementById("ss7");
                    element.innerHTML = xhr.responseText;
                } else {
                    console.log("HTTP error", xhr.status, xhr.statusText);
                }
            };
        }
    </script>
</head>

<body>
    <h1>데이터 조회 및 그래프</h1>

    <h2>Endpoints:</h2>
    <button onclick="getHello()">Get Hello</button>
    <div id="ss1"></div>

    <button onclick="dropMongo()">Drop Mongo</button>
    <div id="ss2"></div>

    <button onclick="insertMongo()">Insert Mongo</button>
    <div id="ss3"></div>

    <h2>Get Data:</h2>
    <label for="start">Start:</label>
    <input type="text" id="start" name="start">
    <label for="end">End:</label>
    <input type="text" id="end" name="end">
    <button onclick="getData()">Get Data</button>
    <div id="ss4"></div>

    <h2>Graph by Date:</h2>
    <!-- <label for="start">Start:</label>
    <input type="text" id="start" name="start">
    <label for="end">End:</label>
    <input type="text" id="end" name="end"> -->
    <button onclick="getGraphByDate()">Graph by Date</button>
    <div id="ss5"></div>

    <h2>Graph by Nationality:</h2>
    <label for="nationality">Nationality:</label>
    <input type="text" id="nationality" name="nationality">
    <button onclick="getGraphByNationality()">Graph by Nationality</button>
    <div id="ss6"></div>

    <h2>Get Top:</h2>
    <!-- <label for="start">Start:</label>
    <input type="text" id="start" name="start">
    <label for="end">End:</label>
    <input type="text" id="end" name="end"> -->
    <button onclick="getTop()">Get Top</button>
    <div id="ss7"></div>
</body>

</html>